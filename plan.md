## Kinoko Bot 画饼

### 预计有的功能

#### 聊天功能

像人一样交流。

- 能够记住每个人的谈话内容，在不同的群聊中共享对这个人的记忆
- 能够在群聊中动态调整聊天参与者
- 能够将聊天记录提炼成训练集
- 能够通过说话调用Bot的其他功能

#### 角色扮演功能

扮演任意角色。

- 可以由用户设定扮演不同的角色进行对话
- 可以加入不同的聊天参与者
- 拥有记忆缓存

### TODO

#### Roleplay功能

- 阉割自Chat
- 内置几个基本场景
  - ？
- 如何处理多个同时发起的1v1聊天
  - 让一个人独占一个RoleplayChat
    - [x] 砍掉currentspeaker功能，只能有一个人用于此对话
  - 不阻塞整个进程的API请求
    - [x] 考虑带回调的speak函数，待请求返回后，调用之（后续考虑用promise实现之）
    - [x] 砍掉消息队列、消息记忆体
  - 如果需要在请求API的过程中再次发起请求，则忽略这次请求
    - [x] 设置busy变量？
  - detach一个线程以处理api请求
    - [ ] 改成join的线程类型，给Roleplay类分配一个线程即可
- 如何处理单个1对多聊天
  - ？

#### 完善WebsocketServer库

- 加入数据帧的打包返回功能

#### 机器人sdk

- 实现对上报的响应
  - [x] 封装MessageEvent类
    - [ ] 派生私聊、群聊信息事件
  - [ ] 封装GoCQhttp_Bot类
- 实现对不同的post_type的回调接口
- 引入access-token

#### 机器人维护消息服务器

随便写了一个，可以用了。



## 一时之念

### Kinoko Project

- [x] 将CompletionParameter归到OpenAI库中
- 考虑自己实现http request库，去除对cpr的依赖
- 考虑做一个基于go-cqhttp的机器人sdk
- 微调OpenAI的api库，考虑提供输入api_key接口（环境变量、代码输入等）
- 插件式的新功能部署
  - 使用lua写业务代码是否可行？考虑使用lua作为插件的模块化语言。
- 电棍语音生成，试着用lua写写

### 代理服务器

弄成开机启动，去掉密码验证，之类的。

用Http实现代理，可能会更安全一点。

## 更新计划

### Kinoko Project

- 机器人sdk

  - 封装MessageEvent、派生私聊消息、群聊消息事件
  - 封装Bot类，抽出接口

- 电棍语音生成，考虑用lua写写

- 
